<html>
<div style="position: relative; left: 1150px; top: 0px;">
<img src="data/logo.png" align="center">
</div> 
<style>
body {
  background-image: url(data/background.jpg);
  background-size: cover;
}
</style>
<font color=#FFFFFF face="Verdana">  
<h1>REX Virtual Machine Documentation</h1>
<h2>Syscalls</h2>
The <b>syscall</b> instruction is provided by the CPU, however what it means is totally implementation defined.<br>
Due to this, REX programs will have huge problems while running on different implementations, to solve this problem<br>
the standard defines certain system calls which need to be present in every implementation. <br>
The following system calls are to be defined in every implementation which conforms to the REX standard.<br>
<b><i>SYSCALL_PUTCH</i></b> - Print an 8-bit ASCII character pushed to stack to stdout or any other graphics device assumed to be stdout<br>
<b><i>SYSCALL_PUTS</i></b> - Print an unformatted string to program's stdout or any other graphics device which is assumed to be stdout.<br>
<b><i>SYSCALL_PUTI/SYSCALL_PUTF</i></b> - Print an integer/float pushed to stack to stdout or any other graphics device assumed to be stdout<br>
<b><i>SYSCALL_GETC</i></b> - Get a character from stdin or an input device assumed to be stdin.<br>
<b><i>SYSCALL_ATOI</i></b> - Convert string which is pointed by the last value pushed to stack, and push the converted value to stack. <br>
<b><i>SYSCALL_ALLOC</b></i> - Allocate one page. The size of one segment is implementation defined. All implementations are required to define a constant "R3_SEGMENT_SIZE"<br>
<b><i>SYSCALL_DISPATCH</i></b> - Dispatch a background job, whose instruction pointer is pushed to stack.<br>
<b><i>SYSCALL_LOADDYANMIC</i></b> - Load a dynamic library and push it's handle.<br>
<b><i>SYSCALL_OPENSTREAM</i></b> - Opens a stream, whose name is pushed to stack, and then pushes the file handle to stack.<br>
<b><i>SYSCALL_SEEKSTREAM</i></b> - Sets pointer in stream. The arguments are in the following order: <br>
<pre>
push [handle]<br>
push [offset] <br>
push [origin] - SEEK_SET (Beginning of file), SEEK_CUR (Current position), SEEK_END (EOF)</pre><br>
<b><i>SYSCALL_READSTREAM/SYSCALL_WRITESTREAM</b></i> - Reads/Writes to/from stream. The arguments are in the following order <br>
<pre>push [handle]<br>
push [buffer address]<br>
push [size] <br></pre>
<b><i>SYSCALL_TELLSTREAM</i></b> - Pushes current pointer of a stream whose handle is pushed to stack<br>
<b><i>SYSCALL_CLOSESTREAM</i></b> - Closes an open stream whose handle is pushed to stack<br>
<h2>Non standard syscalls</h2>
<b><i>SYSCALL_GETCPUCLOCK</b></i> - Returns current CPU time (pushes to stack).<br>
<b><i>SYSCALL_GETCLOCKSPERSEC</b></i> - Return how many CPU clocks are equivalent to 1 second (pushes to stack)<br>
<b><i>SYSCALL_GETARGS</i></b> - Return address of the string which contains program arguments.<br>
</font>
</html>
